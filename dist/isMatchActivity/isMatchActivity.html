<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title></title>
</head>

<body>

</body>
<script>
    window.onload = function() {
        var host = window.location.host;
        var website = '';

        function getQueryString(name) {
            let searchArray = decodeURI(window.location.href).split("?");
            let searchArrayLength = searchArray.length;
            let searchString = decodeURI(window.location.href).split("?")[searchArrayLength - 1];
            let strings = searchString.split("&");
            for (var i = 0; i < strings.length; i++) {
                var pair = strings[i].split("=");
                if (pair[0] == name) {
                    return pair[1].split("#")[0];
                }
            }
            return null
        }

        var activityId = getQueryString('activityId') ? getQueryString('activityId') : '';
        var checkType = getQueryString('checkType') ? getQueryString('checkType') : '';
        var isApp = getQueryString('isApp') ? getQueryString('isApp') : '';
        var browser = {
            versions: function() {
                var u = navigator.userAgent,
                    app = navigator.appVersion;
                var iosVersion = function() {
                    if (/iP(hone|od|ad)/.test(navigator.platform)) {
                        var v = (navigator.appVersion).match(/OS (\d+)_(\d+)_?(\d+)?/);
                        return [parseInt(v[1], 10), parseInt(v[2], 10), parseInt(v[3] || 0, 10)];
                    }
                }();

                var ios9 = iosVersion && iosVersion[0] >= 9;

                return { //移动终端浏览器版本信息
                    trident: u.indexOf('Trident') > -1, //IE内核
                    presto: u.indexOf('Presto') > -1, //opera内核
                    webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
                    gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
                    mobile: !!u.match(/AppleWebKit.*Mobile/i) || !!u.match(/MIDP|SymbianOS|NOKIA|SAMSUNG|LG|NEC|TCL|Alcatel|BIRD|DBTEL|Dopod|PHILIPS|HAIER|LENOVO|MOT-|Nokia|SonyEricsson|SIE-|Amoi|ZTE/), //是否为移动终端
                    ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
                    android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
                    iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者QQHD浏览器
                    iPad: u.indexOf('iPad') > -1, //是否iPad
                    webApp: u.indexOf('Safari') == -1, //是否web应该程序，没有头部与底部
                    ios9: ios9,
                };
            }(),
            language: (navigator.browserLanguage || navigator.language).toLowerCase()
        };
        var ua = navigator.userAgent.toLowerCase();
        var weiXin = ua.match(/MicroMessenger/i) == "micromessenger";
        var weiBo = ua.match(/WeiBo/i) == "weibo";
        var browserType = ''
        if (isApp) {
            browserType = 1
        } else if (weiXin) {
            browserType = 2
        } else if (weiBo) {
            browserType = 3
        } else {
            browserType = 4
        }

        if (host === 'frontend.onairm.cn') {
            website = "http://api.v2.onairm.cn/";
        } else if (host === 't.frontend.onairm.cn') {
            website = "http://t.api.v2.onairm.cn/";
        } else {
            website = "http://d.api.v2.onairm.cn/";
        }
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function() {
            if (xhr.readyState === 4) {
                if (xhr.status === 200) {
                    var data = JSON.parse(xhr.response).data;
                    window.location.href = data.url
                }
            }

        };
        xhr.open('get', website + 'omhsp/isMatchActivity?browser=' + browserType + '&checkType=' + checkType + '&activityId=' + activityId, false);
        xhr.send()
    }
</script>

</html>
